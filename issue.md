**DeliveryServiceImpl**

```java
public DeliveryDto updateDelivery(Long id, DeliveryRequest deliveryRequest) {
    ...
    if (daysBetween < 3) { 
        throw new IllegalArgumentException("Нельзя редактировать доставку менее чем за 3 дня до даты доставки");
    }
    ...
    if (courier.getRole().ordinal() != 2) { 
        throw new IllegalArgumentException("Пользователь не является курьером");
    }
    ...
}
```
```java
@Override
public void deleteDelivery(Long id) {
    ...
    long daysBetween = ChronoUnit.DAYS.between(LocalDate.now(), delivery.getDeliveryDate());
    if (daysBetween < 3) { 
        throw new IllegalArgumentException("Нельзя удалить доставку менее чем за 3 дня до даты доставки");
    }
    ...
}
```
```java
private void validateRouteTime(DeliveryRequest deliveryRequest) {
    ...
    int breakMinutesPerPoint = 30; 
    ...
}
```
```java
private void validateRouteTime(DeliveryRequest deliveryRequest) {
    ...
    long totalRequiredMinutes = (long)(requiredHours.doubleValue() * 60) + totalBreakMinutes; 
    ...
}
```

---

### Описание недостатка

В коде используются "магические числа" (магические константы) без объяснения их смысла и назначения. Эти числовые значения разбросаны по коду без централизованного определения, что затрудняет их понимание и изменение.

---

### Почему данный код является плохим

1. **Непонятный смысл числовых значений**

    * Число `3` — минимальное количество дней до доставки для редактирования/удаления
    * Число `2` — числовое представление роли курьера (используется ordinal(), что само по себе является антипаттерном)
    * Число `30` — количество минут перерыва на точку доставки
    * Число `60` — коэффициент перевода часов в минуты

2. **Сложность поддержки и изменения**

   При необходимости изменить бизнес-правила (например, увеличить лимит редактирования доставки с 3 до 5 дней) потребуется искать все вхождения числа `3` в коде, что чревато ошибками.

3. **Нарушение принципа DRY (Don't Repeat Yourself)**

   Значение `3` используется в двух разных методах (`updateDelivery` и `deleteDelivery`), но определено в каждом из них отдельно.

4. **Использование ordinal() для ролей**

   Сравнение `courier.getRole().ordinal() != 2` является хрупким — изменение порядка элементов в enum сломает логику приложения.

5. **Отсутствие семантики**

   Числовые значения не несут смысловой нагрузки. Что такое `2`? Это ID роли, уровень доступа или что-то еще?

---

### К чему может привести наличие такого кода

* **Ошибки при изменении бизнес-логики** — можно изменить значение в одном месте и забыть про другое
* **Сложность рефакторинга** — необходимо анализировать каждое числовое значение в контексте
* **Снижение читаемости кода** — новые разработчики тратят время на понимание смысла чисел
* **Нарушение консистентности** — разные значения в разных частях приложения для одного и того же бизнес-правила
* **Проблемы с тестированием** — сложно понять граничные значения для тестов

---

### Почему мог появиться данный недостаток

* Быстрая разработка без учета долгосрочной поддерживаемости
* Отсутствие практики выделения констант и конфигурационных параметров
* Непонимание важности семантического именования
* Копирование кода без рефакторинга
* Отсутствие code review, сосредоточенного на качестве кода
* Следование устаревшим шаблонам кодирования
* Недостаточное внимание к принципам чистого кода и проектирования